
```SQL

dbo.Fun_DateCompare(@date1,@date2,@format)

dbo.Fun_TimeCompare(@time1,@time2,@format)

dbo.Fun_DateTimeCompare(@datetime1,@datetime2,@format)

```

**参数解释：**
@date1、@date2：日期变量或日期常量，格式必须相同
@datetime1、@datetime2：日期时间变量或日期时间常量，格式必须相同
@time1、@time2：时间变量或时间常量，格式必须相同
@FORMAT：指示参数1和参数2的日期格式，不区分大小写（例如：yyyy-MM-dd、yyyy-MM-dd HH:mm、yyyy-MM-dd HH:mm:ss）

**结果返回：**
①若不可比较，则返回空值（''）
②若date1 < date2 / datetime1 < datetime1 ，则返回文本'1'
③若date1 = date2 / datetime1 = datetime1 ，则返回文本'0'
④若date1 > date2 / datetime1 > datetime1 ，则返回文本'-1'

**逻辑运行规则参考：**
函数比较两个日期时间变量时，会将日期时间变量中的uk部分舍去，舍去后如果得到的两个日期时间变量的值的格式一致，且有意义（如得到年，年月，年月日，月日，月，日，年月日时，年月日时分，时，时分，时分秒），则直接进行比较并返回比较结果；若得到的两个日期时间变量的值的格式不一致且有意义（如年月日字段，月录入未知则舍去月后得到的内容无意义），则按照最小的（如得到年月日与年月，则最小的格式为年月）进行数据截取，然后比较大小，此时函数仅能判断两个日期时间变量的大小，无法判断为相等（如两个日期时间变量的值为2020-04-10与2020-04，此函数无法进行判断，若两个日期时间变量的值为2020-04-10与2020-03，此函数返回结果为-1）

**复制模板：**

dbo.Fun_DateCompare( , , 'yyyy-MM-dd' ) = ''

dbo.Fun_TimeCompare( , , 'HH:mm:ss' ) = ''

dbo.Fun_DateTimeCompare( , , 'yyyy-MM-dd HH:mm' ) = ''

**补充：**
注意不允许嵌套函数（取值函数除外），比如使用Dateadd()处理参数